if(typeof dojo!=="undefined"){dojo.provide("org.cometd")}else{this.org=this.org||{};org.cometd={}}org.cometd.JSON={};org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(a){throw"Abstract"};org.cometd.Utils={};org.cometd.Utils.isString=function(a){if(a===undefined||a===null){return false}return typeof a==="string"||a instanceof String};org.cometd.Utils.isArray=function(a){if(a===undefined||a===null){return false}return a instanceof Array};org.cometd.Utils.inArray=function(b,c){for(var a=0;a<c.length;++a){if(b==c[a]){return a}}return -1};org.cometd.Utils.setTimeout=function(a,c,b){return setTimeout(function(){try{c()}catch(d){a._debug("Exception invoking timed function",c,d)}},b)};org.cometd.TransportRegistry=function(){var b=[];var a={};this.getTransportTypes=function(){return b.slice(0)};this.findTransportTypes=function(d,h,e){var c=[];for(var f=0;f<b.length;++f){var g=b[f];if(a[g].accept(d,h,e)===true){c.push(g)}}return c};this.negotiateTransport=function(g,c,k,e){for(var f=0;f<b.length;++f){var h=b[f];for(var d=0;d<g.length;++d){if(h==g[d]){var l=a[h];if(l.accept(c,k,e)===true){return l}}}}return null};this.add=function(e,g,c){var f=false;for(var d=0;d<b.length;++d){if(b[d]==e){f=true;break}}if(!f){if(typeof c!=="number"){b.push(e)}else{b.splice(c,0,e)}a[e]=g}return !f};this.find=function(d){for(var c=0;c<b.length;++c){if(b[c]==d){return a[d]}}return null};this.remove=function(d){for(var c=0;c<b.length;++c){if(b[c]==d){b.splice(c,1);var e=a[d];delete a[d];return e}}return null};this.reset=function(){for(var c=0;c<b.length;++c){a[b[c]].reset()}}};org.cometd.Transport=function(){var a;var b;this.registered=function(d,c){a=d;b=c};this.unregistered=function(){a=null;b=null};this._debug=function(){b._debug.apply(b,arguments)};this._mixin=function(){return b._mixin.apply(b,arguments)};this.getConfiguration=function(){return b.getConfiguration()};this.getAdvice=function(){return b.getAdvice()};this.setTimeout=function(d,c){return org.cometd.Utils.setTimeout(b,d,c)};this.convertToMessages=function(d){if(org.cometd.Utils.isString(d)){try{return org.cometd.JSON.fromJSON(d)}catch(c){this._debug("Could not convert to JSON the following string",'"'+d+'"');throw c}}if(org.cometd.Utils.isArray(d)){return d}if(d===undefined||d===null){return[]}if(d instanceof Object){return[d]}throw"Conversion Error "+d+", typeof "+(typeof d)};this.accept=function(c,e,d){throw"Abstract"};this.getType=function(){return a};this.send=function(c,d){throw"Abstract"};this.reset=function(){this._debug("Transport",a,"reset")};this.abort=function(){this._debug("Transport",a,"aborted")};this.toString=function(){return this.getType()}};org.cometd.Transport.derive=function(a){function b(){}b.prototype=a;return new b()};org.cometd.RequestTransport=function(){var k=new org.cometd.Transport();var h=org.cometd.Transport.derive(k);var g=0;var a=null;var d=[];var i=[];function c(p){while(i.length>0){var o=i[0];var n=o[0];var m=o[1];if(n.url===p.url&&n.sync===p.sync){i.shift();p.messages=p.messages.concat(n.messages);this._debug("Coalesced",n.messages.length,"messages from request",m.id);continue}break}}function l(q,p){this.transportSend(q,p);p.expired=false;if(!q.sync){var o=this.getConfiguration().maxNetworkDelay;var n=o;if(p.metaConnect===true){n+=this.getAdvice().timeout}this._debug("Transport",this.getType(),"waiting at most",n,"ms for the response, maxNetworkDelay",o);var m=this;p.timeout=this.setTimeout(function(){p.expired=true;if(p.xhr){p.xhr.abort()}var r="Request "+p.id+" of transport "+m.getType()+" exceeded "+n+" ms max network delay";m._debug(r);m.complete(p,false,p.metaConnect);q.onFailure(p.xhr,q.messages,"timeout",r)},n)}}function f(o){var n=++g;var m={id:n,metaConnect:false};if(d.length<this.getConfiguration().maxConnections-1){d.push(m);l.call(this,o,m)}else{this._debug("Transport",this.getType(),"queueing request",n,"envelope",o);i.push([o,m])}}function j(m){var n=m.id;this._debug("Transport",this.getType(),"metaConnect complete, request",n);if(a!==null&&a.id!==n){throw"Longpoll request mismatch, completing request "+n}a=null}function e(q,s){var p=org.cometd.Utils.inArray(q,d);if(p>=0){d.splice(p,1)}if(i.length>0){var o=i.shift();var n=o[0];var r=o[1];this._debug("Transport dequeued request",r.id);if(s){if(this.getConfiguration().autoBatch){c.call(this,n)}f.call(this,n);this._debug("Transport completed request",q.id,n)}else{var m=this;this.setTimeout(function(){m.complete(r,false,r.metaConnect);n.onFailure(r.xhr,n.messages,"error","Previous request failed")},0)}}}h.complete=function(m,o,n){if(n){j.call(this,m)}else{e.call(this,m,o)}};h.transportSend=function(n,m){throw"Abstract"};h.transportSuccess=function(o,m,n){if(!m.expired){clearTimeout(m.timeout);this.complete(m,true,m.metaConnect);if(n&&n.length>0){o.onSuccess(n)}else{o.onFailure(m.xhr,o.messages,"Empty HTTP response")}}};h.transportFailure=function(p,n,o,m){if(!n.expired){clearTimeout(n.timeout);this.complete(n,false,n.metaConnect);p.onFailure(n.xhr,p.messages,o,m)}};function b(o){if(a!==null){throw"Concurrent metaConnect requests not allowed, request id="+a.id+" not yet completed"}var n=++g;this._debug("Transport",this.getType(),"metaConnect send, request",n,"envelope",o);var m={id:n,metaConnect:true};l.call(this,o,m);a=m}h.send=function(m,n){if(n){b.call(this,m)}else{f.call(this,m)}};h.abort=function(){k.abort();for(var m=0;m<d.length;++m){var n=d[m];this._debug("Aborting request",n);if(n.xhr){n.xhr.abort()}}if(a){this._debug("Aborting metaConnect request",a);if(a.xhr){a.xhr.abort()}}this.reset()};h.reset=function(){k.reset();a=null;d=[];i=[]};return h};org.cometd.LongPollingTransport=function(){var b=new org.cometd.RequestTransport();var a=org.cometd.Transport.derive(b);var c=true;a.accept=function(d,f,e){return c||!f};a.xhrSend=function(d){throw"Abstract"};a.transportSend=function(h,g){this._debug("Transport",this.getType(),"sending request",g.id,"envelope",h);var f=this;try{var e=true;g.xhr=this.xhrSend({transport:this,url:h.url,sync:h.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(h.messages),onSuccess:function(j){f._debug("Transport",f.getType(),"received response",j);var k=false;try{var l=f.convertToMessages(j);if(l.length===0){c=false;f.transportFailure(h,g,"no response",null)}else{k=true;f.transportSuccess(h,g,l)}}catch(i){f._debug(i);if(!k){c=false;f.transportFailure(h,g,"bad response",i)}}},onError:function(j,i){c=false;if(e){f.setTimeout(function(){f.transportFailure(h,g,j,i)},0)}else{f.transportFailure(h,g,j,i)}}});e=false}catch(d){c=false;this.setTimeout(function(){f.transportFailure(h,g,"error",d)},0)}};a.reset=function(){b.reset();c=true};return a};org.cometd.CallbackPollingTransport=function(){var c=new org.cometd.RequestTransport();var a=org.cometd.Transport.derive(c);var b=2000;a.accept=function(d,f,e){return true};a.jsonpSend=function(d){throw"Abstract"};a.transportSend=function(n,k){var r=this;var e=0;var f=n.messages.length;var h=[];while(f>0){var q=org.cometd.JSON.toJSON(n.messages.slice(e,e+f));var t=n.url.length+encodeURI(q).length;if(t>b){if(f==1){var p="Bayeux message too big ("+t+" bytes, max is "+b+") for transport "+this.getType();this.setTimeout(function(){r.transportFailure(n,k,"error",p)},0);return}--f;continue}h.push(f);e+=f;f=n.messages.length-e}var m=n;if(h.length>1){var g=0;var j=h[0];this._debug("Transport",this.getType(),"split",n.messages.length,"messages into",h.join(" + "));m=this._mixin(false,{},n);m.messages=n.messages.slice(g,j);m.onSuccess=n.onSuccess;m.onFailure=n.onFailure;for(var l=1;l<h.length;++l){var o=this._mixin(false,{},n);g=j;j+=h[l];o.messages=n.messages.slice(g,j);o.onSuccess=n.onSuccess;o.onFailure=n.onFailure;this.send(o,k.metaConnect)}}this._debug("Transport",this.getType(),"sending request",k.id,"envelope",m);try{var s=true;this.jsonpSend({transport:this,url:m.url,sync:m.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(m.messages),onSuccess:function(u){var v=false;try{var w=r.convertToMessages(u);if(w.length===0){r.transportFailure(m,k,"no response")}else{v=true;r.transportSuccess(m,k,w)}}catch(i){r._debug(i);if(!v){r.transportFailure(m,k,"bad response",i)}}},onError:function(u,i){if(s){r.setTimeout(function(){r.transportFailure(m,k,u,i)},0)}else{r.transportFailure(m,k,u,i)}}});s=false}catch(d){this.setTimeout(function(){r.transportFailure(m,k,"error",d)},0)}};return a};org.cometd.WebSocketTransport=function(){var f=1;var d=2;var l=new org.cometd.Transport();var i=org.cometd.Transport.derive(l);var a;var g=true;var m=false;var e=d;var c={};var j={};var h;var k;i.registered=function(o,n){l.registered(o,n);a=n};i.accept=function(n,p,o){return g&&!!window.WebSocket&&a.websocketEnabled===true};function b(r,o){try{var v=org.cometd.JSON.toJSON(r.messages);h.send(v);this._debug("Transport",this.getType(),"sent",r,"metaConnect =",o);var n=this.getConfiguration().maxNetworkDelay;var q=n;if(o){q+=this.getAdvice().timeout}var t=[];for(var p=0;p<r.messages.length;++p){var w=r.messages[p];if(w.id){t.push(w.id);var u=this;c[w.id]=this.setTimeout(function(){var x="Message "+w.id+" of transport "+u.getType()+" exceeded "+q+" ms max network delay";u._debug(x);delete c[w.id];for(var y in j){if(j[y]===r){delete j[y];break}}r.onFailure(h,r.messages,"timeout",x)},q)}}this._debug("Transport",this.getType(),"waiting at most",q," ms for messages",t,"maxNetworkDelay",n,", timeouts:",c)}catch(s){this.setTimeout(function(){r.onFailure(h,r.messages,"error",s)},0)}}i.onMessage=function(s){this._debug("Transport",this.getType(),"received websocket message",s);if(e===f){var p=this.convertToMessages(s.data);var x=[];for(var r=0;r<p.length;++r){var z=p[r];if(/^\/meta\//.test(z.channel)||z.data===undefined){if(z.id){x.push(z.id);var w=c[z.id];if(w){clearTimeout(w);delete c[z.id];this._debug("Transport",this.getType(),"removed timeout for message",z.id,", timeouts",c)}}}if("/meta/disconnect"===z.channel&&z.successful){h.close()}}var u=false;for(var q=0;q<x.length;++q){var o=x[q];for(var y in j){var n=y.split(",");var t=org.cometd.Utils.inArray(o,n);if(t>=0){u=true;n.splice(t,1);var v=j[y];delete j[y];if(n.length>0){j[n.join(",")]=v}break}}}if(u){this._debug("Transport",this.getType(),"removed envelope, envelopes",j)}k.call(this,p)}};i.onClose=function(){this._debug("Transport",this.getType(),"closed",h);g=m;for(var o in c){clearTimeout(c[o]);delete c[o]}for(var n in j){j[n].onFailure(h,j[n].messages,"closed");delete j[n]}e=d};i.send=function(s,t){this._debug("Transport",this.getType(),"sending",s,"metaConnect =",t);var r=[];for(var p=0;p<s.messages.length;++p){var q=s.messages[p];if(q.id){r.push(q.id)}}j[r.join(",")]=s;this._debug("Transport",this.getType(),"stored envelope, envelopes",j);if(e===f){b.call(this,s,t)}else{var o=s.url.replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",o);h=new window.WebSocket(o);var n=this;h.onopen=function(){n._debug("WebSocket opened",h);m=true;e=f;k=s.onSuccess;b.call(n,s,t)};h.onclose=function(){n.onClose()};h.onmessage=function(u){n.onMessage(u)}}};i.reset=function(){l.reset();if(h){h.close()}g=true;m=false;e=d;c={};j={};h=null;k=null};return i};org.cometd.Cometd=function(T){var au=this;var af=T||"default";var k=false;var ac=new org.cometd.TransportRegistry();var w;var G="disconnected";var aj=0;var aa=null;var W=0;var ae=[];var r=false;var b={};var S=0;var Y=null;var P=[];var K={};var g;var F=false;var at=false;var ad={maxConnections:2,backoffIncrement:1000,maxBackoff:60000,logLevel:"info",reverseIncomingExtensions:true,maxNetworkDelay:10000,requestHeaders:{},appendMessageTypeToURL:true,autoBatch:false,advice:{timeout:60000,interval:0,reconnect:"retry"}};function X(aC,aH,aG){var aB=aH||{};for(var aE=2;aE<arguments.length;++aE){var aD=arguments[aE];if(aD===undefined||aD===null){continue}for(var aF in aD){var aI=aD[aF];if(aI===aH){continue}if(aI===undefined){continue}if(aC&&typeof aI==="object"&&aI!==null){if(aI instanceof Array){aB[aF]=X(aC,[],aI)}else{aB[aF]=X(aC,{},aI)}}else{aB[aF]=aI}}}return aB}this._mixin=X;function C(aB){return org.cometd.Utils.isString(aB)}function y(aB){if(aB===undefined||aB===null){return false}return typeof aB==="function"}function L(aD,aC){if(window.console){var aB=window.console[aD];if(y(aB)){aB.apply(window.console,aC)}}}function d(){L("warn",arguments)}this._warn=d;function n(){if(ad.logLevel!="warn"){L("info",arguments)}}this._info=n;function aA(){if(ad.logLevel=="debug"){L("debug",arguments)}}this._debug=aA;function ax(aE){aA("Configuring cometd object with",aE);if(C(aE)){aE={url:aE}}if(!aE){aE={}}ad=X(false,ad,aE);if(!ad.url){throw"Missing required configuration parameter 'url' specifying the Bayeux server URL"}var aD=/(^https?:)?(\/\/(([^:\/\?#]+)(:(\d+))?))?([^\?#]*)(.*)?/.exec(ad.url);k=aD[3]&&aD[3]!=window.location.host;if(ad.appendMessageTypeToURL){if(aD[8]!==undefined&&aD[8].length>0){n("Appending message type to URI "+aD[7]+aD[8]+" is not supported, disabling 'appendMessageTypeToURL' configuration");ad.appendMessageTypeToURL=false}else{var aC=aD[7].split("/");var aB=aC.length-1;if(aD[7].match(/\/$/)){aB-=1}if(aC[aB].indexOf(".")>=0){n("Appending message type to URI "+aD[7]+" is not supported, disabling 'appendMessageTypeToURL' configuration");ad.appendMessageTypeToURL=false}}}}function v(){for(var aD in b){var aE=b[aD];for(var aB=0;aB<aE.length;++aB){var aC=aE[aB];if(aC&&!aC.listener){delete aE[aB];aA("Removed subscription",aC,"for channel",aD)}}}}function ay(aB){if(G!=aB){aA("Status",G,"->",aB);G=aB}}function al(){return G=="disconnecting"||G=="disconnected"}function e(){return ++aj}function aq(aF,aI,aD,aG,aC){try{return aI.call(aF,aG)}catch(aB){aA("Exception during execution of extension",aD,aB);var aE=au.onExtensionException;if(y(aE)){aA("Invoking extension exception callback",aD,aB);try{aE.call(au,aB,aD,aC,aG)}catch(aH){n("Exception during execution of exception callback in extension",aD,aH)}}return aG}}function B(aE){for(var aD=0;aD<P.length;++aD){if(aE===undefined||aE===null){break}var aC=ad.reverseIncomingExtensions?P.length-1-aD:aD;var aG=P[aC];var aF=aG.extension.incoming;if(y(aF)){var aB=aq(aG.extension,aF,aG.name,aE,false);aE=aB===undefined?aE:aB}}return aE}function c(aD){for(var aC=0;aC<P.length;++aC){if(aD===undefined||aD===null){break}var aF=P[aC];var aE=aF.extension.outgoing;if(y(aE)){var aB=aq(aF.extension,aE,aF.name,aD,true);aD=aB===undefined?aD:aB}}return aD}function ao(aF,aE){var aI=b[aF];if(aI&&aI.length>0){for(var aC=0;aC<aI.length;++aC){var aD=aI[aC];if(aD){try{aD.callback.call(aD.scope,aE)}catch(aB){aA("Exception during notification",aD,aE,aB);var aG=au.onListenerException;if(y(aG)){aA("Invoking listener exception callback",aD,aB);try{aG.call(au,aB,aD.handle,aD.listener,aE)}catch(aH){n("Exception during execution of listener callback",aD,aH)}}}}}}}function ar(aF,aE){ao(aF,aE);var aG=aF.split("/");var aD=aG.length-1;for(var aC=aD;aC>0;--aC){var aB=aG.slice(0,aC).join("/")+"/*";if(aC==aD){ao(aB,aE)}aB+="*";ao(aB,aE)}}function u(){if(Y!==null){clearTimeout(Y)}Y=null}function x(aB){u();var aC=K.interval+S;aA("Function scheduled in",aC,"ms, interval =",K.interval,"backoff =",S,aB);Y=org.cometd.Utils.setTimeout(au,aB,aC)}var az;var A;function M(aH,aG,aB,aF){for(var aD=0;aD<aG.length;++aD){var aE=aG[aD];aE.id=""+e();if(aa){aE.clientId=aa}aE=c(aE);if(aE!==undefined&&aE!==null){aG[aD]=aE}else{aG.splice(aD--,1)}}if(aG.length===0){return}var aC=ad.url;if(ad.appendMessageTypeToURL){if(!aC.match(/\/$/)){aC=aC+"/"}if(aF){aC=aC+aF}}var aI={url:aC,sync:aH,messages:aG,onSuccess:function(aK){try{az.call(au,aK)}catch(aJ){aA("Exception during handling of messages",aJ)}},onFailure:function(aK,aM,aN,aL){try{A.call(au,aK,aM,aN,aL)}catch(aJ){aA("Exception during handling of failure",aJ)}}};aA("Send",aI);w.send(aI,aB)}function U(aB){if(W>0||r===true){ae.push(aB)}else{M(false,[aB],false)}}this.send=U;function ab(){S=0}function ah(){if(S<ad.maxBackoff){S+=ad.backoffIncrement}}function O(){++W}function j(){var aB=ae;ae=[];if(aB.length>0){M(false,aB,false)}}function J(){--W;if(W<0){throw"Calls to startBatch() and endBatch() are not paired"}if(W===0&&!al()&&!r){j()}}function s(){if(!al()){var aB={channel:"/meta/connect",connectionType:w.getType()};if(!at){aB.advice={timeout:0}}ay("connecting");aA("Connect sent",aB);M(false,[aB],true,"connect");ay("connected")}}function z(){ay("connecting");x(function(){s()})}function E(aB){if(aB){K=X(false,{},ad.advice,aB);aA("New advice",K)}}function o(aB){u();if(aB){w.abort()}aa=null;ay("disconnected");W=0;ab();if(ae.length>0){A.call(au,undefined,ae,"error","Disconnected");ae=[]}}function t(aE){aa=null;v();if(al()){ac.reset();E(ad.advice)}else{E(X(false,K,{reconnect:"retry"}))}W=0;r=true;g=aE;var aB="1.0";var aF=ac.findTransportTypes(aB,k,ad.url);var aC={version:aB,minimumVersion:"0.9",channel:"/meta/handshake",supportedConnectionTypes:aF,advice:{timeout:K.timeout,interval:K.interval}};var aD=X(false,{},g,aC);w=ac.negotiateTransport(aF,aB,k,ad.url);aA("Initial transport is",w.getType());ay("handshaking");aA("Handshake sent",aD);M(false,[aD],false,"handshake")}function av(){ay("handshaking");r=true;x(function(){t(g)})}function q(aC){ar("/meta/handshake",aC);ar("/meta/unsuccessful",aC);var aB=!al()&&K.reconnect!="none";if(aB){ah();av()}else{o(false)}}function R(aC){if(aC.successful){aa=aC.clientId;var aB=ac.negotiateTransport(aC.supportedConnectionTypes,aC.version,k,ad.url);if(aB===null){throw"Could not negotiate transport with server; client "+ac.findTransportTypes(aC.version,k,ad.url)+", server "+aC.supportedConnectionTypes}else{if(w!=aB){aA("Transport",w,"->",aB);w=aB}}r=false;j();aC.reestablish=F;F=true;ar("/meta/handshake",aC);var aD=al()?"none":K.reconnect;switch(aD){case"retry":ab();z();break;case"none":o(false);break;default:throw"Unrecognized advice action "+aD}}else{q(aC)}}function D(aC,aB){q({successful:false,failure:true,channel:"/meta/handshake",request:aB,xhr:aC,advice:{reconnect:"retry",interval:S}})}function V(aB){ar("/meta/connect",aB);ar("/meta/unsuccessful",aB);var aC=al()?"none":K.reconnect;switch(aC){case"retry":ah();z();break;case"handshake":ac.reset();ab();av();break;case"none":o(false);break;default:throw"Unrecognized advice action"+aC}}function am(aB){at=aB.successful;if(at){ar("/meta/connect",aB);var aC=al()?"none":K.reconnect;switch(aC){case"retry":ab();z();break;case"none":o(false);break;default:throw"Unrecognized advice action "+aC}}else{V(aB)}}function N(aC,aB){at=false;V({successful:false,failure:true,channel:"/meta/connect",request:aB,xhr:aC,advice:{reconnect:"retry",interval:S}})}function i(aB){o(true);ar("/meta/disconnect",aB);ar("/meta/unsuccessful",aB)}function ap(aB){if(aB.successful){o(false);ar("/meta/disconnect",aB)}else{i(aB)}}function l(aC,aB){i({successful:false,failure:true,channel:"/meta/disconnect",request:aB,xhr:aC,advice:{reconnect:"none",interval:0}})}function ag(aB){ar("/meta/subscribe",aB);ar("/meta/unsuccessful",aB)}function aw(aB){if(aB.successful){ar("/meta/subscribe",aB)}else{ag(aB)}}function p(aC,aB){ag({successful:false,failure:true,channel:"/meta/subscribe",request:aB,xhr:aC,advice:{reconnect:"none",interval:0}})}function Z(aB){ar("/meta/unsubscribe",aB);ar("/meta/unsuccessful",aB)}function f(aB){if(aB.successful){ar("/meta/unsubscribe",aB)}else{Z(aB)}}function m(aC,aB){Z({successful:false,failure:true,channel:"/meta/unsubscribe",request:aB,xhr:aC,advice:{reconnect:"none",interval:0}})}function a(aB){ar("/meta/publish",aB);ar("/meta/unsuccessful",aB)}function I(aB){if(aB.successful===undefined){if(aB.data){ar(aB.channel,aB)}else{aA("Unknown message",aB)}}else{if(aB.successful){ar("/meta/publish",aB)}else{a(aB)}}}function Q(aC,aB){a({successful:false,failure:true,channel:aB.channel,request:aB,xhr:aC,advice:{reconnect:"none",interval:0}})}function ak(aC){aC=B(aC);if(aC===undefined||aC===null){return}E(aC.advice);var aB=aC.channel;switch(aB){case"/meta/handshake":R(aC);break;case"/meta/connect":am(aC);break;case"/meta/disconnect":ap(aC);break;case"/meta/subscribe":aw(aC);break;case"/meta/unsubscribe":f(aC);break;default:I(aC);break}}this.receive=ak;az=function az(aD){aA("Received",aD);for(var aB=0;aB<aD.length;++aB){var aC=aD[aB];ak(aC)}};A=function A(aB,aG,aH,aD){aA("handleFailure",aB,aG,aH,aD);for(var aC=0;aC<aG.length;++aC){var aF=aG[aC];var aE=aF.channel;switch(aE){case"/meta/handshake":D(aB,aF);break;case"/meta/connect":N(aB,aF);break;case"/meta/disconnect":l(aB,aF);break;case"/meta/subscribe":p(aB,aF);break;case"/meta/unsubscribe":m(aB,aF);break;default:Q(aB,aF);break}}};function h(aC){var aD=b[aC];if(aD){for(var aB=0;aB<aD.length;++aB){if(aD[aB]){return true}}}return false}function H(aC,aD){var aB={scope:aC,method:aD};if(y(aC)){aB.scope=undefined;aB.method=aC}else{if(C(aD)){if(!aC){throw"Invalid scope "+aC}aB.method=aC[aD];if(!y(aB.method)){throw"Invalid callback "+aD+" for scope "+aC}}else{if(!y(aD)){throw"Invalid callback "+aD}}}return aB}function an(aG,aE,aI,aD){var aC=H(aE,aI);aA("Adding listener on",aG,"with scope",aC.scope,"and callback",aC.method);var aF={channel:aG,scope:aC.scope,callback:aC.method,listener:aD};var aH=b[aG];if(!aH){aH=[];b[aG]=aH}var aB=aH.push(aF)-1;aF.id=aB;aF.handle=[aG,aB];aA("Added listener",aF,"for channel",aG,"having id =",aB);return aF.handle}function ai(aB){var aC=b[aB[0]];if(aC){delete aC[aB[1]];aA("Removed listener",aB)}}this.registerTransport=function(aD,aE,aC){var aB=ac.add(aD,aE,aC);if(aB){aA("Registered transport",aD);if(y(aE.registered)){aE.registered(aD,this)}}return aB};this.getTransportTypes=function(){return ac.getTransportTypes()};this.unregisterTransport=function(aB){var aC=ac.remove(aB);if(aC!==null){aA("Unregistered transport",aB);if(y(aC.unregistered)){aC.unregistered()}}return aC};this.findTransport=function(aB){return ac.find(aB)};this.configure=function(aB){ax.call(this,aB)};this.init=function(aC,aB){this.configure(aC);this.handshake(aB)};this.handshake=function(aB){ay("disconnected");F=false;t(aB)};this.disconnect=function(aD,aE){if(al()){return}if(aE===undefined){if(typeof aD!=="boolean"){aE=aD;aD=false}}var aB={channel:"/meta/disconnect"};var aC=X(false,{},aE,aB);ay("disconnecting");M(aD===true,[aC],false,"disconnect")};this.startBatch=function(){O()};this.endBatch=function(){J()};this.batch=function(aD,aE){var aC=H(aD,aE);this.startBatch();try{aC.method.call(aC.scope);this.endBatch()}catch(aB){aA("Exception during execution of batch",aB);this.endBatch();throw aB}};this.addListener=function(aC,aB,aD){if(arguments.length<2){throw"Illegal arguments number: required 2, got "+arguments.length}if(!C(aC)){throw"Illegal argument type: channel must be a string"}return an(aC,aB,aD,true)};this.removeListener=function(aB){if(!org.cometd.Utils.isArray(aB)){throw"Invalid argument: expected subscription, not "+aB}ai(aB)};this.clearListeners=function(){b={}};this.subscribe=function(aF,aC,aI,aH){if(arguments.length<2){throw"Illegal arguments number: required 2, got "+arguments.length}if(!C(aF)){throw"Illegal argument type: channel must be a string"}if(al()){throw"Illegal state: already disconnected"}if(y(aC)){aH=aI;aI=aC;aC=undefined}var aG=!h(aF);var aE=an(aF,aC,aI,false);if(aG){var aB={channel:"/meta/subscribe",subscription:aF};var aD=X(false,{},aH,aB);U(aD)}return aE};this.unsubscribe=function(aF,aC){if(arguments.length<1){throw"Illegal arguments number: required 1, got "+arguments.length}if(al()){throw"Illegal state: already disconnected"}this.removeListener(aF);var aE=aF[0];if(!h(aE)){var aB={channel:"/meta/unsubscribe",subscription:aE};var aD=X(false,{},aC,aB);U(aD)}};this.clearSubscriptions=function(){v()};this.publish=function(aE,aD,aF){if(arguments.length<1){throw"Illegal arguments number: required 1, got "+arguments.length}if(!C(aE)){throw"Illegal argument type: channel must be a string"}if(al()){throw"Illegal state: already disconnected"}var aB={channel:aE,data:aD};var aC=X(false,{},aF,aB);U(aC)};this.getStatus=function(){return G};this.isDisconnected=al;this.setBackoffIncrement=function(aB){ad.backoffIncrement=aB};this.getBackoffIncrement=function(){return ad.backoffIncrement};this.getBackoffPeriod=function(){return S};this.setLogLevel=function(aB){ad.logLevel=aB};this.registerExtension=function(aB,aF){if(arguments.length<2){throw"Illegal arguments number: required 2, got "+arguments.length}if(!C(aB)){throw"Illegal argument type: extension name must be a string"}var aD=false;for(var aC=0;aC<P.length;++aC){var aE=P[aC];if(aE.name==aB){aD=true;break}}if(!aD){P.push({name:aB,extension:aF});aA("Registered extension",aB);if(y(aF.registered)){aF.registered(aB,this)}return true}else{n("Could not register extension with name",aB,"since another extension with the same name already exists");return false}};this.unregisterExtension=function(aC){if(!C(aC)){throw"Illegal argument type: extension name must be a string"}var aB=false;for(var aD=0;aD<P.length;++aD){var aF=P[aD];if(aF.name==aC){P.splice(aD,1);aB=true;aA("Unregistered extension",aC);var aE=aF.extension;if(y(aE.unregistered)){aE.unregistered()}break}}return aB};this.getExtension=function(aB){for(var aC=0;aC<P.length;++aC){var aD=P[aC];if(aD.name==aB){return aD.extension}}return null};this.getName=function(){return af};this.getClientId=function(){return aa};this.getURL=function(){return ad.url};this.getTransport=function(){return w};this.getConfiguration=function(){return X(true,{},ad)};this.getAdvice=function(){return X(true,{},K)}};
(function(){Ext.Cometd=new org.cometd.Cometd();org.cometd.JSON.toJSON=Ext.encode;org.cometd.JSON.fromJSON=Ext.decode;var b=function(c){return function(d,e){c.onSuccess(d.responseText)}};var a=function(c){return{abort:function(){Ext.Ajax.abort(c)}}};Ext.Cometd.LongPollingTransport=function(){this.xhrSend=function(c){var d=Ext.Ajax.request({url:c.url,method:"POST",headers:c.headers,jsonData:c.body,failure:c.onError,success:new b(c)});return new a(d)}};Ext.Cometd.LongPollingTransport.prototype=new org.cometd.LongPollingTransport();Ext.Cometd.LongPollingTransport.prototype.constructor=Ext.Cometd.LongPollingTransport;Ext.Cometd.CallbackPollingTransport=function(){this.jsonpSend=function(c){var d=Ext.Ajax.request({url:c.url,method:"GET",headers:c.headers,jsonp:"jsonp",jsonData:{message:c.body},failure:c.onError,success:new b(c)});return new a(d)}};Ext.Cometd.CallbackPollingTransport.prototype=new org.cometd.CallbackPollingTransport();Ext.Cometd.CallbackPollingTransport.prototype.constructor=Ext.Cometd.CallbackPollingTransport;Ext.Cometd.registerTransport("long-polling",new Ext.Cometd.LongPollingTransport());Ext.Cometd.registerTransport("callback-polling",new Ext.Cometd.CallbackPollingTransport())})();